<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Creatures</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Page -->
    <div class="page active" id="login-page">
        <div class="login-container">
            <div class="login-header">
                <h1>ğŸ§¬ Barcode Creatures</h1>
                <p class="subtitle">Discover unique creatures from everyday barcodes</p>
            </div>
            <div class="login-content">
                <p class="login-description">Sign in to save your collection to the cloud and sync across devices.</p>
                <button class="btn btn-google" id="google-signin">
                    <span class="google-icon">G</span>
                    Sign in with Google
                </button>
                <div class="login-footer">
                    <p>Your collection will be securely saved and accessible from any device.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scanner Page -->
    <div class="page" id="scanner-page">
        <div class="header">
            <h1>ğŸ”¬ Scan Creature</h1>
            <p class="subtitle">Point camera at any barcode</p>
        </div>

        <div class="scanner-container" id="scanner-container">
            <video id="video" autoplay playsinline></video>
            <div class="scan-guide" id="scan-guide" style="display: none;">
                <div class="scan-guide-corner top-left"></div>
                <div class="scan-guide-corner top-right"></div>
                <div class="scan-guide-corner bottom-left"></div>
                <div class="scan-guide-corner bottom-right"></div>
            </div>
            
            <div class="scanner-controls">
                <button class="btn" id="start-camera">Start Camera</button>
                
                <div id="camera-error" style="display: none;" class="camera-error"></div>
                <div id="success-message" style="display: none;" class="success-message"></div>
                
                <div class="camera-info">
                    <strong>ğŸ“± Camera Scanning:</strong><br>
                    Point camera at barcode and hold steady. Manual entry available in Settings.
                </div>
            </div>

            <div class="stats-display">
                <div class="stat-item-inline">Collection: <strong id="total-count">0</strong></div>
                <div class="stat-item-inline">Last Scan: <strong id="last-scan">None</strong></div>
            </div>
        </div>
    </div>

    <!-- Collection Page -->
    <div class="page" id="collection-page">
        <div class="header">
            <h1>ğŸ“š My Collection</h1>
            <p class="subtitle">Discovered creatures</p>
        </div>

        <div class="collection-header">
            <div class="collection-count">
                <span id="collection-total">0</span> Specimens
            </div>
            <button class="btn btn-small" id="backup-btn">ğŸ’¾ Backup</button>
        </div>

        <div class="filter-group">
            <select id="rarity-filter">
                <option value="">All Rarities</option>
                <option value="Common">Common</option>
                <option value="Uncommon">Uncommon</option>
                <option value="Rare">Rare</option>
                <option value="Epic">Epic</option>
                <option value="Legendary">Legendary</option>
                <option value="Mythic">Mythic</option>
            </select>
            <select id="sort-filter">
                <option value="recent">Recently Added</option>
                <option value="name">Name (A-Z)</option>
                <option value="rarity">Rarity</option>
            </select>
        </div>

        <div class="grid" id="collection-grid"></div>

        <div class="empty-state" id="empty-state" style="display: none;">
            <div class="empty-state-icon">ğŸ”</div>
            <h2>No Creatures Yet</h2>
            <p>Start scanning barcodes to build your collection!</p>
        </div>
    </div>

    <!-- Leaderboards Page -->
    <div class="page" id="leaderboards-page">
        <div class="header">
            <h1>ğŸ† Leaderboards</h1>
            <p class="subtitle">Top collectors worldwide</p>
        </div>

        <div class="settings-container">
            <div class="leaderboard-tabs">
                <button class="leaderboard-tab active" data-category="total">Total Creatures</button>
                <button class="leaderboard-tab" data-category="mythic">Mythic Hunter</button>
                <button class="leaderboard-tab" data-category="tags">Special Tags</button>
            </div>

            <div class="leaderboard-list" id="leaderboard-list">
                <div class="loading-state">
                    <div class="loading-icon">ğŸ”„</div>
                    <p>Loading leaderboards...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Page -->
    <div class="page" id="stats-page">
        <div class="header">
            <h1>ğŸ“Š Statistics</h1>
            <p class="subtitle">Your collection insights</p>
        </div>

        <div class="settings-container">
            <div class="settings-section">
                <h2>Collection Overview</h2>
                <div class="stats-grid-large">
                    <div class="stat-card">
                        <div class="stat-card-icon">ğŸ¯</div>
                        <div class="stat-card-value" id="total-creatures-stat">0</div>
                        <div class="stat-card-label">Total Creatures</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-icon">â­</div>
                        <div class="stat-card-value" id="rarest-creature-stat">None</div>
                        <div class="stat-card-label">Rarest Find</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-icon">ğŸ”¥</div>
                        <div class="stat-card-value" id="recent-scans-stat">0</div>
                        <div class="stat-card-label">Scans This Week</div>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h2>Rarity Breakdown</h2>
                <div id="rarity-breakdown"></div>
            </div>

            <div class="settings-section">
                <h2>Recent Discoveries</h2>
                <div id="recent-discoveries"></div>
            </div>

            <div class="settings-section">
                <h2>Top Stats</h2>
                <div class="trait-grid">
                    <div class="trait-item">
                        <span class="trait-label">Most Common Body</span>
                        <span class="trait-value" id="common-body">-</span>
                    </div>
                    <div class="trait-item">
                        <span class="trait-label">Most Common Color</span>
                        <span class="trait-value" id="common-color">-</span>
                    </div>
                    <div class="trait-item">
                        <span class="trait-label">Avg Eyes per Creature</span>
                        <span class="trait-value" id="avg-eyes">-</span>
                    </div>
                    <div class="trait-item">
                        <span class="trait-label">Avg Limbs per Creature</span>
                        <span class="trait-value" id="avg-limbs">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Page -->
    <div class="page" id="settings-page">
        <div class="header">
            <h1>âš™ï¸ Settings</h1>
            <p class="subtitle">Account & Data</p>
        </div>

        <div class="settings-container">
            <div class="settings-section">
                <h2>Manual Entry</h2>
                <p class="settings-description">Enter barcodes manually if camera isn't working or you can't scan.</p>
                <div class="manual-input active">
                    <div class="input-group">
                        <input type="text" id="barcode-input" placeholder="Enter 12-digit barcode" maxlength="12" pattern="[0-9]*" inputmode="numeric">
                        <button class="btn" id="submit-barcode">Add Creature</button>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h2>Account</h2>
                <div class="settings-item">
                    <div class="settings-label">
                        <strong>Email</strong>
                        <p id="user-email">Loading...</p>
                    </div>
                </div>
                <button class="btn btn-secondary" id="signout-btn">Sign Out</button>
            </div>

            <div class="settings-section">
                <h2>Data Management</h2>
                <p class="settings-description">Your collection is automatically saved to the cloud. You can also create manual backups.</p>
                <button class="btn" id="export-btn">ğŸ“¥ Export Collection</button>
                <button class="btn btn-secondary" id="import-btn">ğŸ“¤ Import Collection</button>
                <input type="file" id="import-file" accept=".json" style="display: none;">
            </div>

            <div class="settings-section">
                <h2>About</h2>
                <p class="settings-description">
                    <strong>Version:</strong> 1.0.0<br>
                    <strong>Storage:</strong> Cloud (Firebase)<br>
                    <strong>Created by:</strong> You!
                </p>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="modal" id="detail-modal">
        <div class="modal-content">
            <button class="modal-close" id="close-modal">Ã—</button>
            <div id="detail-content"></div>
        </div>
    </div>

    <!-- Discovery Modal -->
    <div class="discovery-modal" id="discovery-modal">
        <div class="discovery-content">
            <div class="discovery-title">ğŸ‰ New Discovery!</div>
            <div class="discovery-subtitle">Creature added to collection</div>
            <div class="discovery-creature-display">
                <canvas id="discovery-canvas" width="200" height="200"></canvas>
                <div class="discovery-name">
                    <div class="discovery-scientific" id="discovery-scientific"></div>
                    <div class="discovery-common" id="discovery-common"></div>
                    <div class="discovery-rarity-big" id="discovery-rarity"></div>
                </div>
            </div>
            <div class="source-input-container">
                <label class="source-input-label">What item did you scan?</label>
                <input type="text" class="source-input" id="discovery-source-input" placeholder="e.g., PS5 box, Shampoo bottle">
            </div>
            <button class="discovery-close-btn" id="close-discovery">View Collection</button>
        </div>
    </div>

    <!-- Source Edit Modal -->
    <div class="source-edit-modal" id="source-edit-modal">
        <div class="source-edit-content">
            <div class="source-edit-title">Edit Source Item</div>
            <input type="text" class="source-edit-input" id="source-edit-input" placeholder="What item was this?">
            <div class="source-edit-buttons">
                <button class="source-cancel-btn" id="cancel-source-edit">Cancel</button>
                <button class="source-save-btn" id="save-source-edit">Save</button>
            </div>
        </div>
    </div>

    <!-- Username Modal -->
    <div class="username-modal" id="username-modal">
        <div class="username-modal-content">
            <div class="username-modal-title">Welcome to Barcode Creatures!</div>
            <div class="username-modal-subtitle">Choose your username for leaderboards</div>
            <input type="text" class="username-input" id="username-input" placeholder="Enter username" maxlength="20">
            <div class="username-hint" id="username-hint">Letters, numbers, underscores, and hyphens only</div>
            <div class="username-error" id="username-error" style="display: none;"></div>
            <button class="username-save-btn" id="save-username">Continue</button>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav" id="main-nav" style="display: none;">
        <button class="nav-btn active" data-page="scanner-page">
            <div class="nav-icon">ğŸ“·</div>
            <div>Scanner</div>
        </button>
        <button class="nav-btn" data-page="collection-page">
            <div class="nav-icon">ğŸ“š</div>
            <div>Collection</div>
        </button>
        <button class="nav-btn" data-page="leaderboards-page">
            <div class="nav-icon">ğŸ†</div>
            <div>Leaderboards</div>
        </button>
        <button class="nav-btn" data-page="stats-page">
            <div class="nav-icon">ğŸ“Š</div>
            <div>Stats</div>
        </button>
        <button class="nav-btn" data-page="settings-page">
            <div class="nav-icon">âš™ï¸</div>
            <div>Settings</div>
        </button>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Barcode Scanner Library -->
    <script src="https://unpkg.com/@zxing/library@0.19.1/umd/index.min.js"></script>
    
    <!-- App Scripts -->
    <script src="firebase-config.js"></script>
    <script src="creature-generator.js"></script>
    <script src="app.js"></script>
</body>
</html>
